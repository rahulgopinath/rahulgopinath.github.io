<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Z3 WASM</title>
    <script src="/resources/js/z3/z3.js"></script>
    <script src="coi-serviceworker.js"></script> <!-- should be at the level of this page -->
    <script>
    // From https://www.philipzucker.com/replacing-rise4fun/
    // Hosted for teaching.
    // https://github.com/gzuidhof/coi-serviceworker
    window.coi = {
        // // A function that is run to decide whether to register the SW or not.
        // You could for instance make this return a value based on whether you actually need to be cross origin isolated or not.
        shouldRegister: () => true,
        // If this function returns true, any existing service worker will be deregistered (and nothing else will happen).
        shouldDeregister: () => false,
        // Override this if you want to prompt the user and do reload at your own leisure. Maybe show the user a message saying:
        // "Click OK to refresh the page to enable <...>"
        doReload: () => window.location.reload(),
        // Set to true if you don't want coi to log anything to the console.
        quiet: false
    }
    </script>
</head>

<body>
  <script>
   function run(){
       const dot = document.getElementById("query").value;
       createZ3().then(Z3 => {
          console.log('Z3 loaded.');
          try {
             Z3._init_context()
             const ret = Z3._eval_smt2(dot)
             Z3.destroy_context()
             res = ret.trim();
             const div = document.getElementById("result");
             div.innerHTML = res;
          } catch (error) {
             console.error(error);
             div.innerHTML = error;
          }
       });
   }
  </script>
  <textarea id="query" rows="20" style="width:100%">
(echo "Hello world")
  </textarea>
  <button onclick="run()">Run</button>
  <code id="result" style="white-space:pre-wrap"> </code>

</body>

</html>
