<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
<title>Create ICS Calendar Invite</title>
<style>
</style>
<script
  defer src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script defer src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</head>
<body>
    <div id="container" class="container">
<H2>Create ICS Calendar Invite</H2>

<style>
        .form-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .form-group label {
            flex: 1;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            flex: 2;
        }

        button, input[type="submit"] {
            margin: 10px 5px;
        }
    </style>
    <script>
        function generateICS() {
            const event_name = document.getElementById("eventName").value;
            const start_datetime = new Date(document.getElementById("startDatetime").value);
            const end_datetime = new Date(document.getElementById("endDatetime").value);
            const description = document.getElementById("description").value;
            const location = document.getElementById("location").value;
            const organizer = document.getElementById("organizer").value;
            const status = document.getElementById("status").value;
            const priority = document.getElementById("priority").value;

            // Convert the datetime to the ICS format
            const start_datetime_ics = start_datetime.toISOString().replace(/[-:]/g, '').split('.')[0] + "Z";
            const end_datetime_ics = end_datetime.toISOString().replace(/[-:]/g, '').split('.')[0] + "Z";
            const dtstamp = new Date().toISOString().replace(/[-:]/g, '').split('.')[0] + "Z";
            const uid = Date.now() + "-" + event_name.replace(/[^a-zA-Z0-9]/g, '');

            // Create the ICS content
            let ics_content = "BEGIN:VCALENDAR\r\n";
            ics_content += "VERSION:2.0\r\n";
            ics_content += "BEGIN:VEVENT\r\n";
            ics_content += "SUMMARY:" + event_name + "\r\n";
            ics_content += "DTSTART:" + start_datetime_ics + "\r\n";
            ics_content += "DTEND:" + end_datetime_ics + "\r\n";
            ics_content += "DTSTAMP:" + dtstamp + "\r\n";
            ics_content += "UID:" + uid + "\r\n";
            ics_content += "DESCRIPTION:" + description + "\r\n";
            ics_content += "LOCATION:" + location + "\r\n";
            ics_content += "ORGANIZER:" + organizer + "\r\n";
            ics_content += "STATUS:" + status + "\r\n";
            ics_content += "PRIORITY:" + priority + "\r\n";
            ics_content += "END:VEVENT\r\n";
            ics_content += "END:VCALENDAR\r\n";

            document.getElementById("icsOutput").value = ics_content;
        }

        function copyToClipboard() {
            const textBox = document.getElementById("icsOutput");
            textBox.select();
            document.execCommand("copy");
        }

        function downloadICS() {
            const ics_content = document.getElementById("icsOutput").value;
            const blob = new Blob([ics_content], { type: "text/calendar" });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.style.display = "none";
            a.href = url;
            a.download = "event.ics";
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
        }
    </script>

<form onsubmit="event.preventDefault(); generateICS();">
    <div class="form-group">
        <label for="eventName">Event Name:</label>
        <input type="text" id="eventName" required>
    </div>
    <div class="form-group">
        <label for="startDatetime">Start Date and Time:</label>
        <input type="datetime-local" id="startDatetime" required>
    </div>
    <div class="form-group">
        <label for="endDatetime">End Date and Time:</label>
        <input type="datetime-local" id="endDatetime" required>
    </div>
    <div class="form-group">
        <label for="location">Location:</label>
        <input type="text" id="location">
    </div>
    <div class="form-group">
        <label for="organizer">Organizer:</label>
        <input type="text" id="organizer">
    </div>
    <div class="form-group">
        <label for="status">Status:</label>
        <select id="status">
            <option value="CONFIRMED">Confirmed</option>
            <option value="TENTATIVE">Tentative</option>
            <option value="CANCELLED">Cancelled</option>
        </select>
    </div>
    <div class="form-group">
        <label for="priority">Priority:</label>
        <select id="priority">
            <option value="0">Undefined</option>
            <option value="1">Highest (1)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">Medium (5)</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">Lowest (9)</option>
        </select>
    </div>
    <div class="form-group">
        <label for="description">Description:</label>
        <textarea id="description" rows="4" cols="50"></textarea>
    </div>
    <input type="submit" value="Generate ICS" style="margin: 10px 5px;">
</form>

<h3>Generated ICS Content:</h3>
<textarea id="icsOutput" rows="10" cols="70"></textarea><br>
<button onclick="copyToClipboard()">Copy</button>
<button onclick="downloadICS()">Download</button>
</body>
</html>
