---
layout: post
category : blog
tagline: "."
tags : [sunmicrosystems blog sun]
e: Scripting with servlets [php - using quercus]  - part VII  (Sun Java System WebServer 7.0)
---
{% raw %}
<div class="entry" id="scripting_with_servlets_php_using">

	<h3 class="entry-title">
			Scripting with servlets [php - using quercus]  - part VII  (Sun Java System WebServer 7.0)
	    </h3>

    <h4 class="entry-meta">By blue on <a href="#">Jan 31, 2007</a>
</h4>

    <div class="entry-body">
                                        	<p>Scripting with servlets [using quercus implementation of php (over jvm)]</p>
<p><b>Hack Warning</b></p>
<p>     The steps described below are plainly a simple hack to get the Quercus implementation of <br>php working with Sun's WebServer 7.0. This will get you started and gives only the base language.<br>I have not tested any of the libraries and do not expect any of them to work. The hack involves<br>removing the dependency of Resin server from the distributed open-sourced Quercus codebase.</p>
<h3>More info: </h3>
<p>For a detailed treatment of running the <b>Native</b> php on Sun Java System see Joe's <a href="http://developers.sun.com/prodtech/webserver/reference/techart/php2.html" title="Running php natively on Sun's WebServer">article</a>. The difference<br>here is that we use the <a href="http://www.caucho.com/resin-3.0/quercus/" title="quercus on resin.">Quercus</a> implementation of php over jvm provided by <a href="http://www.caucho.com" title="Caucho Home page.">Caucho</a>.<br>We use Quercus implementation distributed with the Resin 3.0 which was opensourced by Caucho.</p>
<p>Unlike the previous installments of this series, This entry does not make use of the ScriptingServlet or the Scripting<br>interface of jdk6. I have tried to make use of the servlet (slightly modified) that allows Quercus to run on Resin, and<br>have modified it slightly to run on Sun Java System WebServer 7.0. </p>
<p>More over, I have added the diffs required to get Quercus to work in Sun Java System WebServer <a href="http://blogs.sun.com/blue/resource/servlets/resin.patch" title="patch to Resin source.">here</a>. It should<br>help any one else who are interested. (note that all the lines that states 'Only in' are the directories that were removed<br>from the original Caucho distribution)<br></p>
<h3>About the language</h3>
<p>The php is a powerful server-side templating language. It is widely used and is an alternative to technologies<br>like ASP, JSP etc. The strength of php is that it is easy to use and its syntax is closely related to Perl and C.<br></p>
<p>Steps involved for the Users.<br></p>
<ol>
<li>Download the <a title="quercus webapp" href="http://blogs.sun.com/blue/resource/servlets/quercus-webapp.tar.gz">quercus-webapp.tar.gz</a>
</li>
<li>Extract it to the <b>samples/java/webapps/quercus</b> directory in your installation. (same as previous entries)</li>
<li>Download the below jars and put them inside <b>samples/java/webapps/quercus/docroot/WEB-INF/lib</b>
</li>
</ol>
<ul>
<li>
<a title="amber" href="http://blogs.sun.com/blue/resource/php-jars/amber-resin.jar">amber-resin.jar</a>  <br>
</li>
<li>
<a title="ejb" href="../../blue/resource/php-jars/ejb-resin.jar">ejb-resin.jar</a> <br>
</li>
<li>
<a title="javax" href="../../blue/resource/php-jars/javax-resin.jar">javax-resin.jar</a> <br>
</li>
<li>
<a title="lib" href="../../blue/resource/php-jars/lib-resin.jar">lib-resin.jar</a> <br>
</li>
<li>
<a title="amber" href="../../blue/resource/php-jars/main-resin.jar">main-resin.jar</a> <br>
</li>
<li>
<a title="parser" href="../../blue/resource/php-jars/parser-resin.jar">parser-resin.jar</a> <br>
</li>
<li>
<a title="amber" href="../../blue/resource/php-jars/server-resin.jar">server-resin.jar</a> <br>
</li>
</ul>
<li>compile the PhpServlet by invoking Ant from your quercus/src directory. <br>
</li>
<ul><li>(This will create quercus-webapp.war in your quercus directory)</li></ul>
<li>deploy it by invoking the deploy.tcl in your quercus directory.</li>
<ul><li>
<font size="2" face="courier new,courier,monospace" color="#0f11ff">wadm </font><font size="2" face="courier new,courier,monospace" color="#0f11ff"> -u admin</font><font size="2" face="courier new,courier,monospace" color="#0f11ff"> -f deploy.tcl</font> <br>
</li></ul>
<p>The directory should look like the following after the jars are downloaded.</p>
<p><br><font size="2" color="#473f42">|cd quercus<br>|find .<br>.<br>./docs<br>./docs/index.html<br>./src<br>./src/build.xml<br>./src/HelloModule.java<br>./src/docroot<br>./src/docroot/WEB-INF<br>./src/docroot/WEB-INF/lib<br>./src/docroot/WEB-INF/lib/aopalliance.jar<br>./src/docroot/WEB-INF/lib/amber-resin.jar<br>./src/docroot/WEB-INF/lib/ejb-resin.jar<br></font><font size="2" color="#473f42">./src/docroot/WEB-INF/lib/javax-resin.jar<br>./src/docroot/WEB-INF/lib/lib-resin.jar<br></font><font size="2" color="#473f42">./src/docroot/WEB-INF/lib/main-resin.jar<br>./src/docroot/WEB-INF/lib/parser-resin.jar<br>./src/docroot/WEB-INF/lib/server-resin.jar<br>./src/docroot/WEB-INF/web.xml<br>./src/docroot/WEB-INF/sun-web.xml<br>./src/docroot/WEB-INF/classes<br>./src/docroot/WEB-INF/classes/META-INF<br>./src/docroot/WEB-INF/classes/META-INF/services<br>./src/docroot/WEB-INF/classes/META-INF/services/com.caucho.quercus.QuercusModule<br>./src/docroot/index.html<br>./src/docroot/hello.php<br>./src/PhpServlet.java<br>./resin.patch<br>./deploy.tcl<br></font></p>
<p>(There are multiple jar files only because the blogs.sun.com does not permit me to upload files more<br>than 3.0 MB at once.)<br></p>
<h3>Callbacks to Java Land</h3>
<p> You might have noticed two interesting files in the previous listing..<br>    <font size="2" color="#0003ff">HelloModule.java</font> and <font size="2" color="#0003ff">com.caucho.quercus.QuercusModule</font><br></p>
<p> </p>
<p> The <b>HelloModule.java</b> contains a simple implementation of a php function. hello_test. (The class name does not matter.)<br></p>
<table width="675" height="88" cellspacing="1" cellpadding="1" border="1" align="center">
<tbody><tr><td style="width: 100%;">
<p><font size="2" color="#8e2020">package example;<br>import com.caucho.quercus.module.AbstractQuercusModule;</font></p>
<p><font size="2" color="#8e2020">public class HelloModule extends AbstractQuercusModule {<br>    public String hello_test(String name) {<br>        return "at, " + (new java.util.Date()).toString() + " for " + name;<br>    }<br>}<br></font></p>
</td></tr></tbody>
</table>
<p> </p>
<p>and the <b>com.caucho.quercus.QuercusModule</b> contains a single string that tells the Quercus what class to load</p>
<p> </p>
<table width="675" height="88" cellspacing="1" cellpadding="1" border="1" align="center">
<tbody><tr><td style="width: 100%;"><p><font size="2" color="#8e2020">example.HelloModule</font></p></td></tr></tbody>
</table>
<p>The <b>hello.php</b> file below invokes the php function we have thus defined.<br> </p>
<table width="675" height="88" cellspacing="1" cellpadding="1" border="1" align="center">
<tbody><tr><td style="width: 100%;"><p><font size="2" color="#8e2020">&lt;html&gt;<br>&lt;body&gt;<br>&lt;?php echo "Hello, "; ?&gt;<br>&lt;br/&gt;<br>&lt;?php echo hello_test("World"); ?&gt;<br>&lt;br/&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></font></p></td></tr></tbody>
</table>
<p>You will be able to invoke your application as </p>
<p>         <font size="2" color="#0003ff">http://yourserver:port/quercus/hello.php</font> <br></p>
<p>once you have deployed the webapp.<br></p>
<p> </p>
        
    </div>

    <div class="entry-footer">
        <p class="entry-category">Category: scripting</p>
        <p class="entry-tags">Tags:    
    	    <a href="https://blogs.oracle.com/blue/tags/jvm" rel="tag">jvm</a> 
  	    <a href="https://blogs.oracle.com/blue/tags/php" rel="tag">php</a> 
  	    <a href="https://blogs.oracle.com/blue/tags/quercus" rel="tag">quercus</a> 
  	    <a href="https://blogs.oracle.com/blue/tags/resin" rel="tag">resin</a> 
  	    <a href="https://blogs.oracle.com/blue/tags/scripting" rel="tag">scripting</a> 
  	    <a href="https://blogs.oracle.com/blue/tags/sevlet" rel="tag">sevlet</a> 
    
 </p>
        <p class="entry-links">
        <a href="https://blogs.oracle.com/blue/entry/scripting_with_servlets_php_using">Permanent link to this entry</a>
                        </p>
    </div>

	    
	</div>
{% endraw %}
